---
title: "Analysis of `r params$dataset` by `r params$var`"
format: gfm
date: "`r Sys.Date()`"

execute:
  message: false
  warning: false

params:
  dataset: iris
  var: "Petal.Width"
---

```{r}
#| echo: false
# Extract data set of interest ------------------------------------------------- 
sample_iris_data <- withr::with_seed(
  seed = 111,
  sample_n(iris, 6)
)
```

### Frequency table for variable: `r params$var`   

The frequency table for `r params$var` is displayed below.  

```{r}
#| echo: false
#| output: true
# Output table -----------------------------------------------------------------
sample_iris_data |>
  dplyr::group_by(Species) |>
  dplyr::summarise(mean = mean(params$var)) |>
  knitr::kable()
```


### Plot for variable: `r params$var`   

The plot for `r params$var` is displayed below.  

```{r}
#| echo: false
#| output: true
# Output histogram if variable is numeric and bar plot if otherwise ------------
library(ggplot2)

sample_iris_data |> 
  ggplot() +
  geom_boxplot(aes(x = params$var, fill = Species)) +
  theme_minimal()
```